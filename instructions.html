<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>123 Fixpoint Extractor - Instructions</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Open Sans', sans-serif;
            background-color: #F8F7FB; /* Soft light background, similar to index.html light mode */
            color: #444444;
            padding-bottom: 50px; /* Space for footer or end of content */
        }
        .container {
            margin-top: 30px;
            background-color: #FFFFFF;
            padding: 20px 30px;
            border-radius: 12px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
        }
        h4, h5 {
            font-family: 'Roboto Slab', serif;
            color: #5B4A8C; /* Deeper Muted Purple */
        }
        h5 {
            margin-top: 25px;
            margin-bottom: 15px;
            border-bottom: 1px solid #E0E0E0;
            padding-bottom: 8px;
        }
        ul {
            padding-left: 20px;
        }
        ul li {
            list-style-type: disc;
            margin-bottom: 10px;
            line-height: 1.6;
        }
        ul ul li {
            list-style-type: circle;
            margin-left: 20px;
        }
        code {
            background-color: #f0f0f0;
            padding: 2px 5px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: #c7254e; /* Bootstrap's code color */
        }
        .nav-wrapper {
            background-color: #8E7DBF; /* Muted Purple, similar to index.html primary */
        }
        .nav-wrapper a.brand-logo, .nav-wrapper ul a {
            color: #FFFFFF;
        }
        .material-icons.tiny {
            font-size: 1.2rem; /* Slightly larger for better visibility in text */
            vertical-align: middle; /* Align icons better with text */
            margin: 0 2px;
        }
        .btn-back {
            margin-top: 20px;
            background-color: #8E7DBF !important;
        }
        .btn-back:hover {
            background-color: #5B4A8C !important;
        }
        @media (max-width: 600px) {
            .container {
                margin-top: 10px;
                padding: 15px 20px;
            }
            h4 {
                font-size: 1.8rem;
            }
            h5 {
                font-size: 1.4rem;
            }
        }
    </style>
</head>
<body>
    <nav>
        <div class="nav-wrapper container">
            <a href="#" class="brand-logo">Extractor Instructions</a>
            <ul id="nav-mobile" class="right">
                <li><a href="index.html" onclick="goBackOrToIndex(event)">Back to App</a></li>
            </ul>
        </div>
    </nav>

    <div class="container">
        <h4>How to Use 123 Fixpoint Extractor v2.5</h4>
        <p>This guide explains the main features of the Fixpoint Extractor tool. Some features are specific to the Team Lead (TL) role.</p>

        <h5>1. Login</h5>
        <ul>
            <li>On loading the app, a login modal will appear.</li>
            <li>Select your role: "Login as TL" (Team Lead) or "Login as Tech".</li>
            <li>If "Login as TL" is selected, you must enter the correct TL Login Code.</li>
            <li>Click "Login" to access the application.</li>
        </ul>

        <h5>2. Main Interface Overview</h5>
        <ul>
            <li><strong>Dark Mode Toggle:</strong> Click the sun <i class="material-icons tiny">brightness_high</i> / moon <i class="material-icons tiny">brightness_4</i> icon at the top right of the main application page to switch themes.</li>
            <li><strong>Project Selection:</strong> Use the "Load Project" dropdown to select a previously saved project. Its data will be loaded for calculations.</li>
        </ul>

        <h5>3. Project Management (Primarily TL Role)</h5>
        <p><em>Most project management buttons are visible only to TLs on the main application page.</em></p>
        <ul>
            <li><strong>Add New Project <i class="material-icons tiny">add</i>:</strong> (TL Only) Click the floating green "+" button.
                <ul>
                    <li>Enter a unique "Project Name".</li>
                    <li>Paste the raw "Fixpoints Data" (typically tab-separated or comma-separated values from a spreadsheet).</li>
                    <li>Select the "Project Size" (3IN or 9IN).</li>
                    <li>Check the "IR Multiplier" box if applicable for this project (this doubles the points for each category entry).</li>
                    <li>Click "Save Project".</li>
                </ul>
            </li>
            <li><strong>Edit Project <i class="material-icons tiny">edit</i>:</strong> (TL Only) First, load a project using the dropdown. Then, click "Edit Project". The project's details will populate the form. Make changes and click "Update Project".</li>
            <li><strong>Delete Project <i class="material-icons tiny">delete</i>:</strong> (TL Only) Load a project, then click "Delete Project". A confirmation will be required.</li>
            <li><strong>View Project Data <i class="material-icons tiny">table_chart</i>:</strong> (All Roles) Load a project, then click "View Data" to see its complete raw data in a table format within a modal.</li>
            <li><strong>Update Projects Online <i class="material-icons tiny">cloud_download</i>:</strong> (All Roles) Fetches and updates the local project list from a predefined online source (managed by the TL). This can add new projects or update existing ones.</li>
            <li><strong>Copy All Projects Data <i class="material-icons tiny">content_copy</i>:</strong> (TL Only) Copies all projects stored in your browser (compressed) to the clipboard. This is useful for backup or sharing with another TL. The format is specifically for the "Update Projects Online" feature.</li>
        </ul>

        <h5>4. Performing Calculations (All Roles)</h5>
        <p><em>Ensure a project is loaded before performing calculations related to that project.</em></p>
        <ul>
            <li><strong>Search TECH ID <i class="material-icons tiny">search</i>:</strong>
                <ul>
                    <li>Enter a Technician's ID (e.g., <code>TECH123</code>) in the "Search TECH ID" field.</li>
                    <li>Click "Search". Results for that specific TECH ID within the loaded project will be displayed. This includes points per category, total points, quality percentage, bonus percentage, quality bonus, and estimated salary.</li>
                    <li>The result box has an "Expand" button <i class="material-icons tiny">fullscreen</i> and a "View Data for this TECH ID" button <i class="material-icons tiny">table_chart</i>.</li>
                </ul>
            </li>
            <li><strong>Per Project Total <i class="material-icons tiny">calculate</i>:</strong>
                <ul>
                    <li>Click this button to calculate and display a summary table for ALL TECH IDs found within the currently loaded project.</li>
                    <li>The table shows detailed metrics for each TECH ID, similar to the single search.</li>
                    <li>This result box also has an "Expand" button <i class="material-icons tiny">fullscreen</i>.</li>
                </ul>
            </li>
            <li><strong>All Projects Total <i class="material-icons tiny">grid_on</i>:</strong>
                <ul>
                    <li>Click this button. A modal will appear asking for a "Multiplier" (defaults to 1).</li>
                    <li>Enter a multiplier if needed and click "Apply Multiplier".</li>
                    <li>The tool will then calculate and display an aggregated summary for ALL TECH IDs across ALL projects currently saved in your browser. The multiplier is applied to the sum of base total points from all projects for each TECH ID. Quality and bonus percentages are based on these pre-multiplied aggregated base totals. The final "Estimated Salary" is calculated as `(AggregatedBaseTotalPoints * Multiplier) + QualityBonus_from_AggregatedBaseTotalPoints`.</li>
                </ul>
            </li>
        </ul>

        <h5>5. Understanding the Raw Data Format (for TLs creating projects)</h5>
        <p>The "Fixpoints Data" is crucial for accurate calculations. It expects a header row followed by data rows. Key columns that the calculator looks for (column headers are case-insensitive):</p>
        <ul>
            <li><code>FIX1_ID</code>: The Technician's ID. This is used to group data per technician.</li>
            <li><code>CATEGORY</code>, <code>I3QA_CAT</code>, <code>RV1_CAT</code>, <code>AFP1_CAT</code>, <code>AFP2_CAT</code>, <code>RV2_CAT</code>: These columns should contain numerical values (1-9) representing the category of work. Points are assigned based on these categories and the project size (3IN/9IN). The system sums points from all these category columns if present for a row.</li>
            <li><code>AFP1_STAT</code>: If this column contains "AA", it counts towards "Additional FixPoints".</li>
            <li><code>RV1_LABEL</code>, <code>I3QA_LABEL</code>, <code>RV2_LABEL</code>: The system checks these labels for:
                <ul>
                    <li>"E": Counts towards "Excessive FixPoints".</li>
                    <li>"M": Counts towards "Miss FixPoints".</li>
                    <li>"I": Counts towards "Incorrect Counting" (instances). The points associated with the category specified in <code>RV1_CAT</code> (if "I" is in <code>RV1_LABEL</code>) or <code>RV2_CAT</code> (if "I" is in <code>RV2_LABEL</code>) for that specific row are summed up as "Incorrect Points Value". This value is then subtracted from the total points to calculate the "Correct Points" for quality percentage derivation.</li>
                </ul>
            </li>
        </ul>

        <h5>6. Exporting & Clearing Data</h5>
        <ul>
            <li><strong>Download CSV <i class="material-icons tiny">file_download</i>:</strong> (All Roles) After any calculation result is displayed (single search, per-project, or all-projects), click this button to download the displayed summary table as a CSV file.</li>
            <li><strong>Clear All Data <i class="material-icons tiny">clear_all</i>:</strong> (All Roles, but use with extreme caution) This button will delete ALL projects and associated data stored in your browser's local storage. A confirmation is required. This action cannot be undone.</li>
        </ul>

        <h5>7. Logout</h5>
        <ul>
            <li><strong>Logout / Change Role <i class="material-icons tiny">logout</i>:</strong> (All Roles) Click this button on the main application page to log out of the current session and return to the login selection screen.</li>
        </ul>

        <div class="center-align" style="margin-top: 30px;">
             <a href="index.html" class="btn waves-effect waves-light btn-back" onclick="goBackOrToIndex(event)">
                <i class="material-icons left">arrow_back</i>Back to Application
            </a>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Materialize components if any are used dynamically in the future
            // For now, just the navbar might need it if it becomes interactive
            M.AutoInit();
        });

        function goBackOrToIndex(event) {
            event.preventDefault(); // Stop the default link behavior
            if (document.referrer && document.referrer.includes('index.html')) {
                // If the referrer is the index.html page (meaning they came from there)
                history.back();
            } else {
                // Otherwise, or if history.back() is not reliable (e.g., direct navigation)
                window.location.href = 'index.html';
            }
        }
    </script>
</body>
</html>
